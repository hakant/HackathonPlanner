<template>

  <require from="../blur-image"></require>
  <require from="./markdown"></require>

  <div class="modal modal-fixed-footer" id="card-detail" validate.bind="project.validation">
    <div class="modal-content">
      <div class="modal-header">
        <canvas class="header-bg" width="500" height="100" blur-image.bind="image"></canvas>
        <img src.bind="project._user.avatar_url" crossorigin ref="image" class="circle">
      </div>
      <div class="row">
        <div class="col s5">
            <h5 class="light-blue-text">${project._user.name ? project._user.name : project._user.login}</h5>
        </div>
        <div class="col s2"></div>
        <div class="col s5">
          <div class="modal-title">
            <h5 class="light-blue-text right" if.bind="!TitleEditEnabled" click.delegate="EnableTitleEdit($event)">${project._title}</h5>
          </div>
        </div>
      </div>
      <div class="divider"></div>
      <div>
        <md-input show.bind="TitleEditEnabled" md-label="Title" md-value.bind="project._title" md-disabled.bind="disabledValue" validate="_title"></md-input>
      </div>
      <div show.bind="TitleEditEnabled">
        <button md-button="flat: true;" md-waves class="light-blue white-text" click.delegate="SaveTitle()">Save</button>
        <button md-button="flat: true;" md-waves class="red white-text" click.delegate="CancelTitle()">Cancel</button>
      </div>
      <div if.bind="!OverviewEditEnabled" class="card-overview" click.delegate="EnableOverviewEdit($event)">
        <p markdown.bind="project._overview" class="flow-text"></p>
      </div>
      <div class="input-field col s12">
        <textarea class="materialize-textarea" show.bind="OverviewEditEnabled" type="text" value.bind="project._overview" validate="_overview"></textarea>
      </div>
      <div>
        <button show.bind="OverviewEditEnabled"md-button="flat: true;" md-waves class="light-blue white-text" click.delegate="SaveOverview()">Save</button>
        <button show.bind="OverviewEditEnabled"md-button="flat: true;" md-waves class="red white-text" click.delegate="CancelOverview()">Cancel</button>
      </div>
    </div>
    <div class="modal-footer">
      <div class="modal-actions row">
        <div class="col s4">
          <div class="chip left  ${!project.liked ? 'light-blue' : 'green'} white-text" data-projectid.bind="project._id" click.trigger="like($event)"> ${project.likeCount} <i class="material-icons">${!project.liked ? 'favorite_border' : 'favorite'} </i> </div>
        </div>
        <div class="col s4 center-text">
          <a md-button="flat: true;" md-waves="color: accent;" class="modal-action modal-close" click.trigger="controller.cancel()">Back to overview</a>
        </div>
        <div class="col s4">
          <div class="chip right ${!project.joined ? 'light-blue' : 'green'} white-text" data-projectid.bind="project._id" click.trigger="join($event)"> ${project.teamCount} <i class="material-icons">${!project.joined ? 'person_outline' : 'person'}</i> </div>
        </div>
      </div>
    </div>
  </div>

</template>
